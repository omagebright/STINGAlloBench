# STINGAlloBench- `FB_Omage_etal_2023`

<img src="https://www.cbi.cnptia.embrapa.br/SMS/images/logo_topo_centro_dir.gif" style="width: 160px; float: right;"/>

<br/>

<p align="justify">

STINGAlloBench: A benchmarking dataset for precise allosteric site prediction using experimentally validated data, tailored for computational biology and machine learning.

## Overview

Our model is based on the nanoenvironment concept, which describes the local structural and physicochemical properties of a protein region. We use a set of 298 descriptors extracted from the Blue Star STING database to characterize the nanoenvironment of each amino acid residue in a protein, using several classifier algorithms. Our model achieves an accuracy of 86.7% and an F1-score of 0.76 on a benchmark dataset of 50 proteins with known exosites.

## Folder

The folder contains the following Data/files:

-   **`allosteric_proteins`**: Retrieved from the [**ASBench**](https://academic.oup.com/bioinformatics/article/31/15/2598/188062?login=false): benchmarking sets for allosteric discovery. This folder contain 235 proteins apo-protein structures.

-   **`protein-modulator_complexes`**: Retrieved from [ASBench](https://academic.oup.com/bioinformatics/article/31/15/2598/188062?login=false "ASBench: benchmarking sets for allosteric discovery Wenkang Huang, Guanqiao Wang, Qiancheng Shen, Xinyi Liu, Shaoyong Lu, Lv Geng, Zhimin Huang, Jian Zhang") contains 235 proteins in complex with the ligands binding to an exosite. In the PDB files we addressed, issues with missing atomic radius for 4AWO, 3F9N, 1T49, 4DLR, 4C7B, during LASA (*Lost accessible surface area*), this was addressed by replacing them with new PDB files from the protein databank. Issue with 1PCQ was addressed by reducing it to a single chain, 2RDE missing from the folder was simply replaced.

    The work [*Huang et al., 2015*](https://academic.oup.com/bioinformatics/article/31/15/2598/188062?login=false)*,* provided the necessary 3D structures for this study.

-   **`complete_LASA`**: Folder containing LASA (Loss of Accessible Surface Area) Calculation

    LASA is a measure of the change in the accessible surface area (ASA) of a protein residue when it forms a complex with another molecule. ASA is the surface area of a molecule that is exposed to the solvent. LASA can be used to identify the residues that are involved in the binding interface of the complex, as well as the residues that are affected by the conformational changes or allosteric effects of the binding.

    The formula for calculating LASA for a residue is:

    > *LASA=ASAapo​−ASAcomplex*

    where *ASAapo​* is the ASA of the residue in the unbound protein (apo) structure, and *ASAcomplex​* is the ASA of the residue in the bound protein (complex) structure.

    The folder `complete_LASA` contains the results of the LASA calculation for each residue of 235 proteins.

    The output files are named as `<protein_id>.txt`, where `<protein_id>` is the identifier of the protein.

-   **`exosite_annotated`**: This folder contains the annotated residues based on the residue interacting with the ligand or not as defined by the LASA.

``` {.python .console}

If residue is 5A around Ligand and LASA > 0. Return 'EFR'
else
Return 'FRs'
```

-   **`exosite_residues.txt`** and **`non_exosite_residues.txt`** files. The features are extracted from the Blue Star STING database and the IPN Dictionary. The table has 299 columns: the first column is the residue ID, and the rest are the feature names and values.

## Code

The code folder contains the following files:

-   **`exosite_prediction.py`**: The main script that trains and evaluates the SVM model on the data. It also generates a confusion matrix and a ROC curve for the model performance.

-   **`exosite_utils.py`**: A module that contains some helper functions for data processing and feature extraction.

-   **`requirements.txt`**: A file that specifies the Python packages and versions required to run the code.

### SQL

``` {.sqlmysql .console}
# Calculating correlations between the tables

SELECT 
    (SUM(x*y) - SUM(x) * SUM(y) / COUNT(*)) / 
    (SQRT(SUM(x*x) - SUM(x) * SUM(x) / COUNT(*)) * SQRT(SUM(y*y) - SUM(y) * SUM(y) / COUNT(*))) as correlation
FROM 
    (SELECT acc_isol_surfv as x, acc_ifr_surfv as y FROM Air LIMIT 1000000) as dt;
    
# Sample query for retrieval

SELECT pdb_code, convert(chain_name, char(1)), number, side_chain_angle_3_WNASurf, side_chain_angle_4_WNASurf, side_chain_angle_5_WNASurf, side_chain_angle_6_WNASurf, side_chain_angle_7_WNASurf, side_chain_average_angle_3_WNASurf, side_chain_average_angle_4_WNASurf, side_chain_average_angle_5_WNASurf, side_chain_average_angle_6_WNASurf, side_chain_average_angle_7_WNASurf, neighbors_side_chain_angle_3_WNASurf, neighbors_side_chain_angle_4_WNASurf, neighbors_side_chain_angle_5_WNASurf, neighbors_side_chain_angle_6_WNASurf, neighbors_side_chain_angle_7_WNASurf, side_chain_angle_3_WNADist, side_chain_angle_4_WNADist, side_chain_angle_5_WNADist, side_chain_angle_6_WNADist, side_chain_angle_7_WNADist, side_chain_average_angle_3_WNADist, side_chain_average_angle_4_WNADist, side_chain_average_angle_5_WNADist, side_chain_average_angle_6_WNADist, side_chain_average_angle_7_WNADist, neighbors_side_chain_angle_3_WNADist, neighbors_side_chain_angle_4_WNADist, neighbors_side_chain_angle_5_WNADist, neighbors_side_chain_angle_6_WNADist, neighbors_side_chain_angle_7_WNADist FROM Side_Chain_Orientation_WNA WHERE pdb_code = '2ZMF' AND chain_name = 'A';


# Queries wrapped using pymysql in the attached python script
```

-   Retrieved descriptors from the STINGRDB2

| Table Name                  | Columns                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|-----------|-------------------------------------------------------------|
| Air                         | pdb_code, convert(chain_name, char(1)), number, acc_isol_surfv, acc_isol_naccess, acc_isol_nsc, acc_complex_surfv, acc_complex_naccess, acc_complex_nsc, acc_ifr_surfv, acc_ifr_naccess, acc_ifr_nsc, acc_rsa_surfv, acc_rsa_naccess, acc_rsa_nsc, bsa_ratio_surfv, bsa_ratio_naccess, bsa_ratio_nsc                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Cross_Link_Order_WNA        | pdb_code, convert(chain_name, char(1)), number, clo_35_15_CB_WNASurf, clo_35_15_LHA_WNASurf, clo_35_20_LHA_WNASurf, clo_35_30_LHA_WNASurf, clo_5\_15_CA_WNASurf, clo_5\_15_CB_WNASurf, clo_5\_15_LHA_WNASurf, clo_5\_20_CA_WNASurf, clo_5\_20_CB_WNASurf, clo_5\_20_LHA_WNASurf, clo_5\_30_CA_WNASurf, clo_5\_30_CB_WNASurf, clo_5\_30_LHA_WNASurf, clo_85_15_CA_WNASurf, clo_85_15_CB_WNASurf, clo_85_15_LHA_WNASurf, clo_85_20_CA_WNASurf, clo_85_20_CB_WNASurf, clo_85_20_LHA_WNASurf, clo_85_30_CA_WNASurf, clo_85_30_CB_WNASurf, clo_85_30_LHA_WNASurf, clo_35_15_CA_WNADist, clo_35_15_CB_WNADist, clo_35_15_LHA_WNADist, clo_35_20_CA_WNADist, clo_35_20_CB_WNADist, clo_35_20_LHA_WNADist, clo_35_30_CA_WNADist, clo_35_30_CB_WNADist, clo_35_30_LHA_WNADist, clo_5\_15_CA_WNADist, clo_5\_15_CB_WNADist, clo_5\_15_LHA_WNADist, clo_5\_20_CA_WNADist, clo_5\_20_CB_WNADist, clo_5\_20_LHA_WNADist, clo_5\_30_CA_WNADist, clo_5\_30_CB_WNADist, clo_5\_30_LHA_WNADist, clo_85_15_CA_WNADist, clo_85_15_CB_WNADist, clo_85_15_LHA_WNADist, clo_85_20_CA_WNADist, clo_85_20_CB_WNADist, clo_85_20_LHA_WNADist, clo_85_30_CA_WNADist, clo_85_30_CB_WNADist, clo_85_30_LHA_WNADist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Cross_Presence_Order_WNA    | pdb_code, convert(chain_name, char(1)), number, cpo_35_15_LHA_WNASurf, cpo_35_20_LHA_WNASurf, cpo_35_30_LHA_WNASurf, cpo_5\_15_LHA_WNASurf, cpo_5\_20_LHA_WNASurf, cpo_5\_30_LHA_WNASurf, cpo_85_15_CA_WNASurf, cpo_85_20_CA_WNASurf, cpo_85_30_CA_WNASurf, cpo_85_15_CB_WNASurf, cpo_85_20_CB_WNASurf, cpo_85_30_CB_WNASurf, cpo_85_15_LHA_WNASurf, cpo_85_20_LHA_WNASurf, cpo_85_30_LHA_WNASurf, cpo_35_15_LHA_WNADist, cpo_35_20_LHA_WNADist, cpo_35_30_LHA_WNADist, cpo_5\_15_LHA_WNADist, cpo_5\_20_LHA_WNADist, cpo_5\_30_LHA_WNADist, cpo_85_15_CA_WNADist, cpo_85_20_CA_WNADist, cpo_85_30_CA_WNADist, cpo_85_15_CB_WNADist, cpo_85_20_CB_WNADist, cpo_85_30_CB_WNADist, cpo_85_15_LHA_WNADist, cpo_85_20_LHA_WNADist, cpo_85_30_LHA_WNADist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Curvature_WNA               | pdb_code, convert(chain_name, char(1)), number, curvature_isol_WNASurf, asa_isol_WNASurf, msa_isol_WNASurf, curvature_complex_WNASurf, asa_complex_WNASurf, msa_complex_WNASurf, cavity_curvature_isol_WNASurf, cavity_asa_isol_WNASurf, cavity_msa_isol_WNASurf, cavity_curvature_complex_WNASurf, cavity_asa_complex_WNASurf, cavity_msa_complex_WNASurf, curvature_isol_WNADist, asa_isol_WNADist, msa_isol_WNADist, curvature_complex_WNADist, asa_complex_WNADist, msa_complex_WNADist, cavity_curvature_isol_WNADist, cavity_asa_isol_WNADist, cavity_msa_isol_WNADist, cavity_curvature_complex_WNADist, cavity_asa_complex_WNADist, cavity_msa_complex_WNADist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| DSSP                        | pdb_code, convert(chain_name, char(1)), number, kappa, phi, acceptor_energy1, acceptor_energy2, donor_energy1, donor_energy2, acceptor_number1, acceptor_number2, donor_number1, donor_number2, fst_bridge_pair_number, snd_bridge_pair_number                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Density_Sponge_WNA          | pdb_code, convert(chain_name, char(1)), number, density_CA_3\_WNASurf, density_CA_4\_WNASurf, density_CA_5\_WNASurf, density_CA_6\_WNASurf, density_CA_7\_WNASurf, density_LHA_3\_WNASurf, density_LHA_4\_WNASurf, density_LHA_5\_WNASurf, density_LHA_6\_WNASurf, density_LHA_7\_WNASurf, density_CA_3\_IFR_WNASurf, density_CA_4\_IFR_WNASurf, density_CA_5\_IFR_WNASurf, density_CA_6\_IFR_WNASurf, density_CA_7\_IFR_WNASurf, density_LHA_3\_IFR_WNASurf, density_LHA_4\_IFR_WNASurf, density_LHA_5\_IFR_WNASurf, density_LHA_6\_IFR_WNASurf, density_LHA_7\_IFR_WNASurf, sponge_CA_3\_WNASurf, sponge_CA_4\_WNASurf, sponge_CA_5\_WNASurf, sponge_CA_6\_WNASurf, sponge_CA_7\_WNASurf, sponge_LHA_3\_WNASurf, sponge_LHA_4\_WNASurf, sponge_LHA_5\_WNASurf, sponge_LHA_6\_WNASurf, sponge_LHA_7\_WNASurf, sponge_CA_3\_IFR_WNASurf, sponge_CA_4\_IFR_WNASurf, sponge_CA_5\_IFR_WNASurf, sponge_CA_6\_IFR_WNASurf, sponge_CA_7\_IFR_WNASurf, sponge_LHA_3\_IFR_WNASurf, sponge_LHA_4\_IFR_WNASurf, sponge_LHA_5\_IFR_WNASurf, sponge_LHA_6\_IFR_WNASurf, sponge_LHA_7\_IFR_WNASurf, density_CA_3\_WNADist, density_CA_4\_WNADist, density_CA_5\_WNADist, density_CA_6\_WNADist, density_CA_7\_WNADist, density_LHA_3\_WNADist, density_LHA_4\_WNADist, density_LHA_5\_WNADist, density_LHA_6\_WNADist, density_LHA_7\_WNADist, density_CA_3\_IFR_WNADist, density_CA_4\_IFR_WNADist, density_CA_5\_IFR_WNADist, density_CA_6\_IFR_WNADist, density_CA_7\_IFR_WNADist, density_LHA_3\_IFR_WNADist, density_LHA_4\_IFR_WNADist, density_LHA_5\_IFR_WNADist, density_LHA_6\_WNADist, density_LHA_7\_WNADist, sponge_CA_3\_WNADist, sponge_CA_4\_WNADist, sponge_CA_5\_WNADist, sponge_CA_6\_WNADist, sponge_CA_7\_WNADist, sponge_LHA_3\_WNADist, sponge_LHA_4\_WNADist, sponge_LHA_5\_WNADist, sponge_LHA_6\_WNADist, sponge_LHA_7\_WNADist, sponge_CA_3\_IFR_WNADist, sponge_CA_4\_IFR_WNADist, sponge_CA_5\_IFR_WNADist, sponge_CA_6\_WNADist, sponge_CA_7\_WNADist, sponge_LHA_3\_IFR_WNADist, sponge_LHA_4\_IFR_WNADist, sponge_LHA_5\_IFR_WNADist, sponge_LHA_6\_WNADist, sponge_LHA_7\_WNADist |
| Distances                   | pdb_code, convert(chain_name, char(1)), number, distance_to_cterminal, distance_to_nterminal, distance_to_cg                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Electrostatic_Potential_WNA | pdb_code, convert(chain_name, char(1)), number, ep_ca_WNASurf, ep_lha_WNASurf, ep_absolute_WNASurf, ep_average_WNASurf, ep_surface_WNASurf, ep_ca_WNADist, ep_lha_WNADist, ep_absolute_WNADist, ep_average_WNADist, ep_surface_WNADist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Energy_Density_WNA          | pdb_code, convert(chain_name, char(1)), number, ced_CA_3\_WNASurf, ced_CA_4\_WNASurf, ced_CA_5\_WNASurf, ced_CA_6\_WNASurf, ced_CA_7\_WNASurf, ced_LHA_3\_WNASurf, ced_LHA_4\_WNASurf, ced_LHA_5\_WNASurf, ced_LHA_6\_WNASurf, ced_LHA_7\_WNASurf, ced_CA_3\_WNADist, ced_CA_4\_WNADist, ced_CA_5\_WNADist, ced_CA_6\_WNADist, ced_CA_7\_WNADist, ced_LHA_3\_WNADist, ced_LHA_4\_WNADist, ced_LHA_5\_WNADist, ced_LHA_6\_WNADist, ced_LHA_7\_WNADist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Entropy_Density_WNA         | pdb_code, convert(chain_name, char(1)), number, entd_CA_3\_WNASurf, entd_CA_4\_WNASurf, entd_CA_5\_WNASurf, entd_CA_6\_WNASurf, entd_CA_7\_WNASurf, entd_LHA_3\_WNASurf, entd_LHA_4\_WNASurf, entd_LHA_5\_WNASurf, entd_LHA_6\_WNASurf, entd_LHA_7\_WNASurf, entd_CA_3\_WNADist, entd_CA_4\_WNADist, entd_CA_5\_WNADist, entd_CA_6\_WNADist, entd_CA_7\_WNADist, entd_LHA_3\_WNADist, entd_LHA_4\_WNADist, entd_LHA_5\_WNADist, entd_LHA_6\_WNADist, entd_LHA_7\_WNADist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Evolutionary_Pressure       | pdb_code, convert(chain_name, char(1)), number, evol_press, normalized_evol_press, bayes_lb, bayes_ub, bayes_std                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Graph_Descriptor_WNA        | pdb_code, convert(chain_name, char(1)), number, eccentricity_WNASurf, radiality_centrality_WNASurf, local_closeness_WNASurf, dice_similarity_WNASurf, mean_neighbor_degree_WNASurf, lac_WNASurf, mnc_WNASurf, dmnc_WNASurf, closeness_WNASurf, cluster_coefficient_WNASurf, degree_WNASurf, betweenness_WNASurf, random_walk_betweenness_WNASurf, bary_center_WNASurf, page_rank_WNASurf, bottle_neck_WNASurf, eccentricity_WNADist, radiality_centrality_WNADist, local_closeness_WNADist, dice_similarity_WNADist, mean_neighbor_degree_WNADist, lac_WNADist, mnc_WNADist, dmnc_WNADist, closeness_WNADist, cluster_coefficient_WNADist, degree_WNADist, betweenness_WNADist, random_walk_betweenness_WNADist, bary_center_WNADist, page_rank_WNADist, bottle_neck_WNADist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| HSSP                        | pdb_code, convert(chain_name, char(1)), number, rel_entropy, entropy, weight                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Hydrophobicity              | pdb_code, convert(chain_name, char(1)), number, hydro_radzicka_isol_surfv, hydro_radzicka_complex_surfv, hydro_kite_dolitte_isol_surfv, hydro_kite_dolitte_complex_surfv, hydro_radzicka_isol_naccess, hydro_radzicka_complex_naccess, hydro_kite_dolitte_isol_naccess, hydro_kite_dolitte_complex_naccess, hydro_radzicka_isol_nsc, hydro_radzicka_complex_nsc, hydro_kite_dolitte_isol_nsc, hydro_kite_dolitte_complex_nsc                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Residue_Contacts_WNA        | pdb_code, convert(chain_name, char(1)), number, hydrophobic_energy_WNASurf, charge_attr_energy_WNASurf, charge_repu_energy_WNASurf, hb_mm_energy_WNASurf, hb_ms_energy_WNASurf, hb_ss_energy_WNASurf, total_energy_WNASurf, hydrophobic_energy_WNADist, charge_attr_energy_WNADist, charge_repu_energy_WNADist, hb_mm_energy_WNADist, hb_ms_energy_WNADist, aromatic_energy_WNADist, hb_ss_energy_WNADist, total_energy_WNADist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Rotamer                     | pdb_code, convert(chain_name, char(1)), number, phi, psi, chi1, chi2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Side_Chain_Orientation_WNA  | pdb_code, convert(chain_name, char(1)), number, side_chain_angle_3\_WNASurf, side_chain_angle_4\_WNASurf, side_chain_angle_5\_WNASurf, side_chain_angle_6\_WNASurf, side_chain_angle_7\_WNASurf, side_chain_average_angle_3\_WNASurf, side_chain_average_angle_4\_WNASurf, side_chain_average_angle_5\_WNASurf, side_chain_average_angle_6\_WNASurf, side_chain_average_angle_7\_WNASurf, neighbors_side_chain_angle_3\_WNASurf, neighbors_side_chain_angle_4\_WNASurf, neighbors_side_chain_angle_5\_WNASurf, neighbors_side_chain_angle_6\_WNASurf, neighbors_side_chain_angle_7\_WNASurf, side_chain_angle_3\_WNADist, side_chain_angle_4\_WNADist, side_chain_angle_5\_WNADist, side_chain_angle_6\_WNADist, side_chain_angle_7\_WNADist, side_chain_average_angle_3\_WNADist, side_chain_average_angle_4\_WNADist, side_chain_average_angle_5\_WNADist, side_chain_average_angle_6\_WNADist, side_chain_average_angle_7\_WNADist, neighbors_side_chain_angle_3\_WNADist, neighbors_side_chain_angle_4\_WNADist, neighbors_side_chain_angle_5\_WNADist, neighbors_side_chain_angle_6\_WNADist, neighbors_side_chain_angle_7\_WNADist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Solvation_WNA               | pdb_code, convert(chain_name, char(1)), solvation_3\_WNASurf, solvation_4\_WNASurf, solvation_5\_WNASurf, solvation_6\_WNASurf, solvation_7\_WNASurf, solvation_3\_WNADist, solvation_4\_WNADist, solvation_5\_WNADist, solvation_6\_WNADist, solvation_7\_WNADist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Stride                      | pdb_code, convert(chain_name, char(1)), number, phi, psi, accessibility                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Unused_Contacts_WNA         | pdb_code, convert(chain_name, char(1)), number, hydrophobic_uc_energy_WNASurf, total_energy_WNASurf, hydrophobic_uc_energy_WNADist, total_energy_WNADist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Weighted_Contact_Number_WNA | pdb_code, convert(chain_name, char(1)), number, weighted_contact_number_WNASurf, avg_weighted_contact_number_k\_2_WNASurf, avg_weighted_contact_number_k\_3_WNASurf, avg_weighted_contact_number_k\_4_WNASurf, avg_weighted_contact_number_k\_5_WNASurf, weighted_contact_number_WNADist, avg_weighted_contact_number_k\_2_WNADist, avg_weighted_contact_number_k\_3_WNADist, avg_weighted_contact_number_k\_4_WNADist, avg_weighted_contact_number_k\_5_WNADist                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

## Usage

To run the code, you need to have Python 3.7 or higher installed on your system. You also need to install the packages listed in the **`requirements.txt`** file. You can do this by running the following command in your terminal:

```         
pip install -r requirements.txt 
```

Then, you can run the **`exosite_prediction.py`** script by typing:

```         
python exosite_prediction.py 
```

The script will output the accuracy, precision, recall, and F1-score of the model on the test set. It will also save the confusion matrix and the ROC curve as **`confusion_matrix.png`** and **`roc_curve.png`** in the code folder.

# CASBench processing

## 1. Removing proteins in study dataset


We removed certain subdirectories or proteins that are contained within the CASbench dataset. This step is crucial to maintaining the integrity of the external test set and ensuring that it reflects the most accurate dataset.

Below is the list of proteins or subdirectories that have been removed:

- `4jaf`
- `4aw0`
- `1i7s`
- `4fyy`
- `4kh1`
- `2be9`
- `1m8p`
- `1ce8`
- `3h30`
- `3f9n`
- `3csm`
- `2ats`
- `3zcw`
- `4bbg`
- `2jjk`
- `1frp`
- `1kz8`
- `1pcq`
- `1hkb`
- `1lth`
- `2ldb`
- `2him`
- `1gz3`
- `2q5o`
- `1fiy`
- `3dc2`
- `2pa3`
- `2bu6`
- `2bu7`
- `2bu8`
- `1a3w`
- `3h6o`
- `4b2d`
- `4g1n`
- `2vgi`
- `3n25`
- `2r1r`
- `3r1r`
- `1peq`
- `1xtu`
- `11bg`
- `3k5v`
- `3pyy`
- `4e6c`
- `2w4i`
- `4b1f`
- `1pfk`
- `2bty`
- `3o2m`
- `2jhr`
- `3bz7`
- `3tw6`
- `1nsg`
- `4hsg`
- `2puv`
- `1shj`
- `1qw7`
- `1t49`
- `3kcg`
- `3n1v`
- `3pxf`

This removal ensures that the CASBench database remains a reliable and accurate resource for the study benchmark with other works. 


## 2. Missing `ALLOSTERIC_LIGANDS.txt` Folders Removed

After removing folders from `CASBench_Download` that do not contain the `ALLOSTERIC_LIGANDS.txt` with allosteric ligand information, the following directories were found to be missing or removed:

- `CASBench_Download/cas0007/*`
- `CASBench_Download/cas0009/*`
- `CASBench_Download/cas0011/*`
- `CASBench_Download/cas0024/*`
- `CASBench_Download/cas0028/*`
- `CASBench_Download/cas0034/*`
- `CASBench_Download/cas0035/*`
- `CASBench_Download/cas0038/*`
- `CASBench_Download/cas0039/*`
- `CASBench_Download/cas0043/*`
- `CASBench_Download/cas0051/*`
- `CASBench_Download/cas0055/*`
- `CASBench_Download/cas0057/*`
- `CASBench_Download/cas0066/*`
- `CASBench_Download/cas0074/*`

These directories were expected to contain `ALLOSTERIC_LIGANDS.txt`, but the file was not found or the directory was missing, leading to their removal from the dataset.

## 3. Create a casbench_first_subfolder that contains just the pdb folders

## 4. modify the complexes to containing only the allosteric ligands in the complex

casbench_allosteric_ligand_only.sh

## 5. 

## References

The following papers and websites are the sources of the data and the methods used in this project:

-   Neshich, G. *et al.* Using Structural and Physical--Chemical Parameters to Identify, Classify, and Predict Functional Districts in Proteins---The Role of Electrostatic Potential. *Computational Electrostatics for Biological Applications* 227--254 (2015) <doi:10.1007/978-3-319-12211-3_12>.

-   Open Terminal on Linux/MacOS or Command Prompt on Windows

-   Enter the following into the console (one line at a time)

``` console
git clone 
jupyter notebook
```

<br/>
